# 调试启动问题指南

如果运行 `start.bat` 仍然失败，请按照以下步骤排查：

## 步骤 1: 直接运行 Java 命令

在命令行中直接运行：

```bash
cd "项目目录"
java -jar target\rootmanage-1.0-SNAPSHOT.jar
```

这样可以查看完整的错误信息，而不会被批处理脚本干扰。

## 步骤 2: 检查常见问题

### 问题 1: 数据库连接失败

**症状**: 错误信息包含 `CommunicationsException` 或 `Access denied`

**解决方案**:
1. 检查 MySQL 服务是否启动
2. 检查 `src/main/resources/application.yml` 中的数据库配置
3. 确认数据库 `rootmanage` 是否已创建
4. 测试数据库连接：
   ```bash
   mysql -u root -p
   # 然后执行
   USE rootmanage;
   SHOW TABLES;
   ```

### 问题 2: 端口被占用

**症状**: 错误信息包含 `Address already in use` 或 `端口已被占用`

**解决方案**:
```bash
# 查看占用 8080 端口的进程
netstat -ano | findstr ":8080"

# 终止进程（将 PID 替换为实际进程ID）
taskkill /PID <PID> /F
```

### 问题 3: JAR 文件损坏或未正确打包

**症状**: 错误信息包含 `no main manifest attribute` 或 `ClassNotFoundException`

**解决方案**:
```bash
# 重新打包
mvn clean package -DskipTests

# 检查 JAR 文件是否存在
dir target\rootmanage-1.0-SNAPSHOT.jar
```

### 问题 4: Java 版本不匹配

**症状**: 错误信息包含 `UnsupportedClassVersionError`

**解决方案**:
```bash
# 检查 Java 版本（需要 Java 17+）
java -version

# 如果版本不对，请安装 Java 17
```

### 问题 5: 内存不足

**症状**: 错误信息包含 `OutOfMemoryError`

**解决方案**:
在 `start.bat` 中修改 Java 启动命令，增加内存：
```batch
java -Xms512m -Xmx1024m -jar target\rootmanage-1.0-SNAPSHOT.jar
```

## 步骤 3: 查看完整日志

如果使用 Maven 运行（不打包），可以看到更详细的日志：

```bash
mvn spring-boot:run
```

这种方式会显示完整的启动日志，更容易定位问题。

## 步骤 4: 检查配置文件

确认 `src/main/resources/application.yml` 配置正确：

```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/rootmanage?useSSL=false&characterEncoding=utf8&serverTimezone=UTC&allowPublicKeyRetrieval=true
    username: root          # 你的数据库用户名
    password: 你的密码       # 你的数据库密码
```

## 步骤 5: 使用 IDE 运行

在 IntelliJ IDEA 中：
1. 打开项目
2. 找到 `RootManageApplication.java`
3. 右键 → Run 'RootManageApplication'
4. 查看控制台的完整错误信息

这样可以获得最详细的错误信息。

