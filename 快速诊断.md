# 快速诊断启动问题

你的应用启动失败，退出代码为 1。请按照以下步骤诊断：

## 🔍 步骤 1: 查看详细错误信息

运行诊断脚本查看完整错误：

```bash
诊断启动问题.bat
```

或者直接在命令行运行：

```bash
java -jar target\rootmanage-1.0-SNAPSHOT.jar
```

这会显示完整的错误堆栈，帮助我们定位问题。

## 🔍 步骤 2: 检查最常见的问题

### 问题 1: 数据库连接失败（最常见）

**检查 MySQL 服务是否启动**：
```bash
# Windows 服务管理器中查看 MySQL 服务状态
# 或在命令行执行：
net start | findstr MySQL
```

**检查数据库是否存在**：
```bash
mysql -u root -p
```
然后执行：
```sql
SHOW DATABASES;
USE rootmanage;
SHOW TABLES;
```

**如果数据库不存在，创建它**：
```sql
CREATE DATABASE IF NOT EXISTS rootmanage 
  DEFAULT CHARACTER SET utf8mb4 
  DEFAULT COLLATE utf8mb4_unicode_ci;
```

**检查 application.yml 配置**：
- 打开 `src/main/resources/application.yml`
- 确认 `username` 和 `password` 正确
- 当前配置：username: root, password: 123456

### 问题 2: 端口被占用

虽然检查显示端口未被占用，但可以再次确认：
```bash
netstat -ano | findstr ":8080"
```

如果被占用，终止进程：
```bash
taskkill /PID <进程ID> /F
```

### 问题 3: Java 版本问题

检查 Java 版本（需要 Java 17+）：
```bash
java -version
```

### 问题 4: 使用 Maven 运行查看更详细的日志

如果直接运行 JAR 看不到详细错误，可以尝试：

```bash
mvn spring-boot:run
```

这种方式会显示更详细的启动日志。

## 🔧 快速修复建议

### 如果数据库连接失败：

1. **确保 MySQL 服务运行**
   - Windows: 服务管理器 → 找到 MySQL → 启动

2. **创建数据库**（如果不存在）：
   ```sql
   CREATE DATABASE rootmanage DEFAULT CHARACTER SET utf8mb4;
   ```

3. **测试数据库连接**：
   ```bash
   mysql -u root -p123456 -e "USE rootmanage; SELECT 1;"
   ```

4. **如果密码不对**，修改 `application.yml`：
   ```yaml
   password: 你的实际密码
   ```

## 📝 需要的信息

请运行 `诊断启动问题.bat` 后，将完整的错误信息复制给我，这样我可以更准确地帮你解决问题。

常见的错误信息类型：

1. **数据库连接错误**：
   ```
   CommunicationsException: Communications link failure
   Access denied for user 'root'@'localhost'
   ```

2. **数据库不存在**：
   ```
   Unknown database 'rootmanage'
   ```

3. **表不存在**：
   ```
   Table 'rootmanage.xxx' doesn't exist
   ```

4. **端口占用**：
   ```
   Address already in use: bind
   ```

